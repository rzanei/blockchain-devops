#!/bin/bash

# List of peers to check
PEERS=("c13ccbfcd70626d42e048f2e79c02b775fcd7944@rpc-akash.whispernode.com:26656"
"ef856e1ef57c4efc396a4e064d04d2f8f5b82e58@akash-rpc.polkachu.com:26656"
"b3d4c223f832a6582be431060efb2a73903dc85b@85.237.193.106:26656"
"66b74927d51888a25fe94bff2dfeaae125739f26@79.127.196.36:29656"
"c58852a0c6ee1d1a68b76e5a54a9dbce895065d9@162.55.245.149:2140"
"ebeea522e069f9037876e13f73310a601cfcff8a@95.179.212.224:26656"
"0d8434034e645d305a0cf294e5670ee59e5e55f0@148.251.53.24:12856"
"ef9221336be2f2cda18f3da3fd3733e2b96d03ee@54.157.107.51:26656"
"b071f46ff940ea8acf7adbd93a7ea78498431a53@86.32.69.228:26656"
"4de4f8839c4afdac12aa3c40b80788e720fcd324@164.152.163.191:26656"
"9744e833f44218fb6f0646e2c37aae1331ce1efc@37.252.186.117:2000"
"5a7599058e1bb208c6d8fe1e8e514d7bd6559980@146.59.81.92:29656"
"be0a6315cbac3a368ff394d314514264d8447057@141.94.139.219:26856"
"893429952c41a3485ea63b5af2886c91f090c065@65.108.76.28:12856"
"7e1ec5bf83a17fc588c04beb807bba0daa4b54e7@207.180.193.18:26656"
"c1606b50f704c787a8db27888f7c620e45ffda8b@142.132.249.130:26646"
"d1e47b071859497089c944dc082e920403484c1a@65.108.128.201:12856"
"1fb2f4a044c08c96f9b527b8c35b7db4425c75e0@141.94.195.151:12856"
"ae80e704ee143075ebd1a92996f4eb5c208ebcee@172.105.110.122:2020"
"dda1f59957f767e20b0fc64b1c915b4799fc0cc5@159.223.201.93:26656"
"a89ded27c2323388fc0f12e7a08f17424b2b7a45@135.181.142.60:15607"
"835c8aab295400dcf52e318f64894f60d84f83b2@185.233.106.174:26656"
"79685f65de2bfc391ecbb1d16a275f10bad1c038@65.109.37.251:26656"
"bd2525f1a86af8b1a3798c04387f47f0c0627d24@159.223.201.38:26656"
"9aa4c9097c818871e45aaca4118a9fe5e86c60e2@135.181.113.227:1506"
"689b88169a9ea8c0780da57216ca7e188d64d3d5@209.145.55.218:26656"
"03493c979e821f9d047715b1aaec0ee969392c76@95.214.53.119:26656"
"82c0ece4f15b830a1982fef0fa103d31ecd563b9@148.251.176.12:2000"
"9b0d47d9872814d7d66ea15e7a5775d9a3bb4da4@5.9.77.116:14756"
"f9215993d48d8e0abc31cea931d573a45d201ac8@65.108.232.104:12856"
"6adc00bef235246c90757547d5f0703d6a548460@178.128.82.28:26656"
"2719d5a0f2ea29bc3d5d48f8487ac07ca94749f7@49.13.153.159:26667"
"59d9af9f89a1c22568ca596184455d644039c104@144.76.15.125:27656"
"bc9c4ccacb089ebbaa3fb91bc9aa6348027a2d12@144.76.115.182:12856"
"02b5a74f0cc909045efe170da3cc5706de2c0be5@88.208.243.62:26656"
"86f866a645bcc25d3d26fe8dffbd603ebfc0d6ee@142.132.158.93:12856")


echo "🔎 Checking peers..."
for peer in "${PEERS[@]}"; do
  node_id=$(echo "$peer" | cut -d@ -f1)
  address=$(echo "$peer" | cut -d@ -f2)
  ip=$(echo "$address" | cut -d: -f1)
  port=$(echo "$address" | cut -d: -f2)

  # Check if port is open (timeout 2s)
  nc -z -w2 "$ip" "$port" &> /dev/null
  if [ $? -eq 0 ]; then
    echo "$peer ✅"
  else
    echo "$peer ❌" >&2
  fi
done
